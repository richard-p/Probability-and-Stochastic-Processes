This is the python implementation.
